import 'dart:developer';

import 'package:flutter_dotenv/flutter_dotenv.dart';
import 'package:google_generative_ai/google_generative_ai.dart';

class GeminiService {
  GeminiService();

  final String API_KEY = dotenv.env['API_KEY']!;

  Future<String?> generateContent(Content prompt) async {
    if (API_KEY == '') {
      throw Exception('API_KEY is null');
    }

    final model = GenerativeModel(
      model: 'gemini-1.5-flash',
      apiKey: API_KEY,
      generationConfig: GenerationConfig(
        temperature: 1,
        topK: 64,
        topP: 0.95,
        maxOutputTokens: 8192,
        responseMimeType: 'text/plain',
      ),
    );

    final response2 = await model.generateContent([prompt]);

    final response = await model.generateContent([
      Content('user', [
        TextPart(
            'Should summarize the important points of the legal document in 200 words')
      ]),
      Content('model', [TextPart('')]),
      Content(
          'user', [TextPart('point out high priority clauses of document')]),
      Content('model', [TextPart('')]),
      Content('user', [TextPart('user: point out unclear clauses')]),
      Content('model', [TextPart('')]),
      Content('user',
          [TextPart('user: point out potential loopholes in the document')]),
      Content('model', [TextPart('')]),
      Content('user', [
        TextPart('user: Expand on the key clauses related to data collection'),
      ]),
      Content('model', [TextPart('')]),
      Content('user', [
        TextPart(
            'user: Identify any privacy-related concerns and potential loopholes in the document'),
      ]),
      Content('model', [TextPart('')]),
      Content('user', [
        TextPart(
            'user: Provide a legal analysis of compliance with GDPR regulations'),
      ]),
      Content('model', [TextPart('')]),
      Content('user', [
        TextPart(
            'user: We want you to understand the types of information we collect as you use our services\n\nWe collect information to provide better services to all our users — from figuring out basic stuff like which language you speak, to more complex things like which ads you’ll find most useful, the people who matter most to you online, or which YouTube videos you might like. The information Google collects, and how that information is used, depends on how you use our services and how you manage your privacy controls.\n\nWhen you’re not signed in to a Google Account, we store the information we collect with unique identifiers tied to the browser, application, or device you’re using. This allows us to do things like maintain your preferences across browsing sessions, such as your preferred language or whether to show you more relevant search results or ads based on your activity.\n\nWhen you’re signed in, we also collect information that we store with your Google Account, which we treat as personal information.\n\nThings you create or provide to us\nWhen you create a Google Account, you provide us with personal information that includes your name and a password. You can also choose to add a phone number or payment information to your account. Even if you aren’t signed in to a Google Account, you might choose to provide us with information — like an email address to communicate with Google or receive updates about our services.\n\nWe also collect the content you create, upload, or receive from others when using our services. This includes things like email you write and receive, photos and videos you save, docs and spreadsheets you create, and comments you make on YouTube videos.\n\nInformation we collect as you use our services\nYour apps, browsers & devices\nWe collect information about the apps, browsers, and devices you use to access Google services, which helps us provide features like automatic product updates and dimming your screen if your battery runs low.\n\nThe information we collect includes unique identifiers, browser type and settings, device type and settings, operating system, mobile network information including carrier name and phone number, and application version number. We also collect information about the interaction of your apps, browsers, and devices with our services, including IP address, crash reports, system activity, and the date, time, and referrer URL of your request.\n\nWe collect this information when a Google service on your device contacts our servers — for example, when you install an app from the Play Store or when a service checks for automatic updates. If you’re using an Android device with Google apps, your device periodically contacts Google servers to provide information about your device and connection to our services. This information includes things like your device type and carrier name, crash reports, which apps you\'ve installed, and, depending on your device settings, other information about how you’re using your Android device.\n\nYour activity\nWe collect information about your activity in our services, which we use to do things like recommend a YouTube video you might like. The activity information we collect may include:\n\nTerms you search for\nVideos you watch\nViews and interactions with content and ads\nVoice and audio information\nPurchase activity\nPeople with whom you communicate or share content\nActivity on third-party sites and apps that use our services\nChrome browsing history you’ve synced with your Google Account\nIf you use our services to make and receive calls or send and receive messages, we may collect call and message log information like your phone number, calling-party number, receiving-party number, forwarding numbers, sender and recipient email address, time and date of calls and messages, duration of calls, routing information, and types and volumes of calls and messages.\n\nYou can visit your Google Account to find and manage activity information that’s saved in your account.\n\n\nGo to Google Account\n\nYour location information\nWe collect location information when you use our services, which helps us offer features like driving directions, search results for things near you, and ads based on your location.\n\nDepending on the products you’re using and settings you choose, Google may use different types of location information to help make some services and products you use more helpful. These include:\n\nGPS and other sensor data from your device\nIP address\nActivity on Google services, such as from your searches or places you label like home or work\nInformation about things near your device, such as Wi-Fi access points, cell towers, and Bluetooth-enabled devices\nThe types of location data we collect and how long we store it depend in part on your device and account settings. For example, you can turn your Android device’s location on or off using the device’s settings app. You can also turn on Location History if you want to create a private map of where you go with your signed-in devices. And if your Web & App Activity setting is enabled, your searches and other activity from Google services, which may also include location information, is saved to your Google Account. Learn more about how we use location information.\n\nIn some circumstances, Google also collects information about you from publicly accessible sources. For example, if your name appears in your local newspaper, Google’s Search engine may index that article and display it to other people if they search for your name. We may also collect information about you from trusted partners, such as directory services who provide us with business information to be displayed on Google’s services, marketing partners who provide us with information about potential customers of our business services, and security partners who provide us with information to protect against abuse. We also receive information from partners to provide advertising and research services on their behalf.\n\nWe use various technologies to collect and store information, including cookies, pixel tags, local storage, such as browser web storage or application data caches, databases, and server logs.\n\nWhy Google collects data\nWe use data to build better services\n\nWe use the information we collect from all our services for the following purposes:\n\nProvide our services\nWe use your information to deliver our services, like processing the terms you search for in order to return results or helping you share content by suggesting recipients from your contacts.\n\nMaintain & improve our services\nWe also use your information to ensure our services are working as intended, such as tracking outages or troubleshooting issues that you report to us. And we use your information to make improvements to our services — for example, understanding which search terms are most frequently misspelled helps us improve spell-check features used across our services.\n\nDevelop new services\nWe use the information we collect in existing services to help us develop new ones. For example, understanding how people organized their photos in Picasa, Google’s first photos app, helped us design and launch Google Photos.\n\nProvide personalized services, including content and ads\nWe use the information we collect to customize our services for you, including providing recommendations, personalized content, and customized search results. For example, Security Checkup provides security tips adapted to how you use Google products. And, depending on your available settings, Google Play could use information like apps you’ve already installed and videos you’ve watched on YouTube to suggest new apps you might like.\n\nDepending on your settings, we may also show you personalized ads based on your interests and activity across Google services. For example, if you search for “mountain bikes,” you may see ads for sports equipment on YouTube. You can control what information we use to show you ads by visiting your ad settings in My Ad Center.\n\nWe don’t show you personalized ads based on sensitive categories, such as race, religion, sexual orientation, or health.\nWe don’t show you personalized ads based on your content from Drive, Gmail, or Photos.\nWe don’t share information that personally identifies you with advertisers, such as your name or email, unless you ask us to. For example, if you see an ad for a nearby flower shop and select the “tap to call” button, we’ll connect your call and may share your phone number with the flower shop.\n\nGo to My Ad Center\n\nMeasure performance\nWe use data for analytics and measurement to understand how our services are used. For example, we analyze data about your visits to our sites to do things like optimize product design. And we also use data about the ads you interact with, including your related Google Search activity, to help advertisers understand the performance of their ad campaigns. We use a variety of tools to do this, including Google Analytics. When you visit sites or use apps that use Google Analytics, a Google Analytics customer may choose to enable Google to link information about your activity from that site or app with activity from other sites or apps that use our ad services.\n\nCommunicate with you\nWe use information we collect, like your email address, to interact with you directly. For example, we may send you a notification if we detect suspicious activity, like an attempt to sign in to your Google Account from an unusual location. Or we may let you know about upcoming changes or improvements to our services. And if you contact Google, we’ll keep a record of your request in order to help solve any issues you might be facing.\n\nProtect Google, our users, and the public\nWe use information to help improve the safety and reliability of our services. This includes detecting, preventing, and responding to fraud, abuse, security risks, and technical issues that could harm Google, our users, or the public.\n\nWe use different technologies to process your information for these purposes. We use automated systems that analyze your content to provide you with things like customized search results, personalized ads, or other features tailored to how you use our services. And we analyze your content to help us detect abuse such as spam, malware, and illegal content. We also use algorithms to recognize patterns in data. For example, Google Translate helps people communicate across languages by detecting common language patterns in phrases you ask it to translate.\n\nWe may use the information we collect across our services and across your devices for the purposes described above. For example, depending on your available settings, if you watch videos of guitar players on YouTube, you might see an ad for guitar lessons on a site that uses our ad products. Depending on your account settings, your activity on other sites and apps may be associated with your personal information in order to improve Google’s services and the ads delivered by Google.\n\nIf other users already have your email address or other information that identifies you, we may show them your publicly visible Google Account information, such as your name and photo. This helps people identify an email coming from you, for example.\n\nWe’ll ask for your consent before using your information for a purpose that isn’t covered in this Privacy Policy.\n\nYour privacy controls\nYou have choices regarding the information we collect and how it\'s used\n\nThis section describes key controls for managing your privacy across our services. You can also visit the Privacy Checkup, which provides an opportunity to review and adjust important privacy settings. In addition to these tools, we also offer specific privacy settings in our products — you can learn more in our Product Privacy Guide.\n\n\nGo to Privacy Checkup\n\nManaging, reviewing, and updating your information\nWhen you’re signed in, you can always review and update information by visiting the services you use. For example, Photos and Drive are both designed to help you manage specific types of content you’ve saved with Google.\n\nWe also built a place for you to review and control information saved in your Google Account. Your Google Account includes:\n\nPrivacy controls\n\nActivity Controls\nDecide what types of activity you’d like saved in your account. For example, if you have YouTube History turned on, the videos you watch and the things you search for are saved in your account so you can get better recommendations and remember where you left off. And if you have Web & App Activity turned on, your searches and activity from other Google services are saved in your account so you can get more personalized experiences like faster searches and more helpful app and content recommendations. Web & App Activity also has a subsetting that lets you control whether information about your activity on other sites, apps, and devices that use Google services, such as apps you install and use on Android, is saved in your Google Account and used to improve Google services.\n\nGo to Activity Controls\n\n\nAd settings\nManage your preferences about the ads shown to you on Google and on sites and apps that partner with Google to show ads. You can modify your interests, choose whether your personal information is used to make ads more relevant to you, and turn on or off certain advertising services.\n\nGo to My Ad Center\n\n\nAbout you\nManage personal info in your Google Account and control who can see it across Google services.\n\nGo to About You\n\n\nShared endorsements\nChoose whether your name and photo appear next to your activity, like reviews and recommendations, that appear in ads.\n\nGo to Shared Endorsements\n\n\nSites and apps that use Google services\nManage information that websites and apps using Google services, like Google Analytics, may share with Google when you visit or interact with their services.\n\nGo to How Google uses information from sites or apps that use our services\n\nWays to review & update your information\n\nMy Activity\nMy Activity allows you to review and control data that’s saved to your Google Account when you’re signed in and using Google services, like searches you’ve done or your visits to Google Play. You can browse by date and by topic, and delete part or all of your activity.\n\nGo to My Activity\n\n\nGoogle Dashboard\nGoogle Dashboard allows you to manage information associated with specific products.\n\nGo to Dashboard\n\n\nYour personal information\nManage your contact information, such as your name, email, and phone number.\n\nGo to Personal Info\n\nWhen you’re signed out, you can manage information associated with your browser or device, including:\n\nSigned-out search personalization: Choose whether your search activity is used to offer you more relevant results and recommendations.\nYouTube settings: Pause and delete your YouTube Search History and your YouTube Watch History.\nAd Settings: Manage your preferences about the ads shown to you on Google and on sites and apps that partner with Google to show ads.\nExporting, removing & deleting your information\nYou can export a copy of content in your Google Account if you want to back it up or use it with a service outside of Google.\n\n\nExport your data\n\nTo delete your information, you can:\n\nDelete your content from specific Google services\nSearch for and then delete specific items from your account using My Activity\nDelete specific Google products, including your information associated with those products\nDelete your entire Google Account\n\nDelete your information\n\nInactive Account Manager allows you to give someone else access to parts of your Google Account in case you’re unexpectedly unable to use your account.\n\nAnd finally, you can also request to remove content from specific Google services based on applicable law and our policies.\n\nThere are other ways to control the information Google collects whether or not you’re signed in to a Google Account, including:\n\nBrowser settings: For example, you can configure your browser to indicate when Google has set a cookie in your browser. You can also configure your browser to block all cookies from a specific domain or all domains. But remember that our services rely on cookies to function properly, for things like remembering your language preferences.\nDevice-level settings: Your device may have controls that determine what information we collect. For example, you can modify location settings on your Android device.\nSharing your information\nWhen you share your information\nMany of our services let you share information with other people, and you have control over how you share. For example, you can share videos on YouTube publicly or you can decide to keep your videos private. Remember, when you share information publicly, your content may become accessible through search engines, including Google Search.\n\nWhen you’re signed in and interact with some Google services, like leaving comments on a YouTube video or reviewing an app in Play, your name and photo appear next to your activity. We may also display this information in ads depending on your Shared endorsements setting.\n\nWhen Google shares your information\nWe do not share your personal information with companies, organizations, or individuals outside of Google except in the following cases:\n\nWith your consent\nWe’ll share personal information outside of Google when we have your consent. For example, if you use Google Home to make a reservation through a booking service, we’ll get your permission before sharing your name or phone number with the restaurant. We also provide you with controls to review and manage third party apps and sites you have given access to data in your Google Account. We’ll ask for your explicit consent to share any sensitive personal information.\n\nWith domain administrators\nIf you’re a student or work for an organization that uses Google services, your domain administrator and resellers who manage your account will have access to your Google Account. They may be able to:\n\nAccess and retain information stored in your account, like your email\nView statistics regarding your account, like how many apps you install\nChange your account password\nSuspend or terminate your account access\nReceive your account information in order to satisfy applicable law, regulation, legal process, or enforceable governmental request\nRestrict your ability to delete or edit your information or your privacy settings\nFor external processing\nWe provide personal information to our affiliates and other trusted businesses or persons to process it for us, based on our instructions and in compliance with our Privacy Policy and any other appropriate confidentiality and security measures. For example, we use service providers to help operate our data centers, deliver our products and services, improve our internal business processes, and offer additional support to customers and users. We also use service providers to help review YouTube video content for public safety and analyze and listen to samples of saved user audio to help improve Google’s audio recognition technologies.\n\nFor legal reasons\nWe will share personal information outside of Google if we have a good-faith belief that disclosure of the information is reasonably necessary to:\n\nRespond to any applicable law, regulation,legal process, or enforceable governmental request. We share information about the number and type of requests we receive from governments in our Transparency Report.\nEnforce applicable Terms of Service, including investigation of potential violations.\nDetect, prevent, or otherwise address fraud, security, or technical issues.\nProtect against harm to the rights, property or safety of Google, our users, or the public.\nWe may share non-personally identifiable information publicly and with our partners — like publishers, advertisers, developers, or rights holders. For example, we share information publicly to show trends about the general use of our services. We also allow specific partners to collect information from your browser or device for advertising and measurement purposes using their own cookies or similar technologies.\n\nIf Google is involved in a merger, acquisition, or sale of assets, we’ll continue to ensure the confidentiality of your personal information and give affected users notice before personal information is transferred or becomes subject to a different privacy policy.\n\nKeeping your information secure\nWe build security into our services to protect your information\n\nAll Google products are built with strong security features that continuously protect your information. The insights we gain from maintaining our services help us detect and automatically block security threats from ever reaching you. And if we do detect something risky that we think you should know about, we’ll notify you and help guide you through steps to stay better protected.\n\nWe work hard to protect you and Google from unauthorized access, alteration, disclosure, or destruction of information we hold, including:\n\nWe use encryption to keep your data private while in transit\nWe offer a range of security features, like Safe Browsing, Security Checkup, and 2 Step Verification to help you protect your account\nWe review our information collection, storage, and processing practices, including physical security measures, to prevent unauthorized access to our systems\nWe restrict access to personal information to Google employees, contractors, and agents who need that information in order to process it. Anyone with this access is subject to strict contractual confidentiality obligations and may be disciplined or terminated if they fail to meet these obligations.')
      ]),
      Content('model', [TextPart('')]),
    ]);

    log(response2.text!);
    return response2.text;
  }
}
